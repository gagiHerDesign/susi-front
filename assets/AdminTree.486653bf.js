import{r as q,H as _,b6 as f,V as c,I as x,j as g,J as k,K as i,l as n,d as t,Q as p,O as F,N as U,b0 as m,R as h,bh as u,P as C,k as T,aU as B,F as S,a_ as A,a$ as w,b1 as D}from"./index.fdefb647.js";import{Q as z,a as E,C as I}from"./ClosePopup.4a5464bf.js";import{Q as K,a as N}from"./QSelect.739e0742.js";import{Q as P}from"./QForm.f376f79b.js";import{Q as $}from"./QImg.f8fda5da.js";import{Q as M}from"./QPage.c6ffe190.js";import"./QItem.e409bbdc.js";import"./rtl.b51694b1.js";import"./format.a33550d6.js";const O={class:"container"},R=n("h6",{style:{"font-weight":"600"}},"\u8336\u6A39\u8CC7\u6599",-1),j={id:"q-app",style:{"min-height":"50vh","max-width":"500px",background:"#FFFEF2",margin:"auto","font-weight":"100"}},H={class:"q-mx-auto q-py-md q-px-xl",style:{"min-width":"400px"}},J={style:{"font-weight":"600"}},L=n("strong",null,"\u9EDE\u64CA\u65B0\u589E\u5716\u7247 : ",-1),G=n("li",null,"\u5927\u5C0F\u9650\u52362mb",-1),W=n("li",null,"\u50C5\u9650\u4E0A\u50B3\u4E00\u5F35\u5716\u7247",-1),X={class:"text-center",style:{"margin-top":"3rem"}},Y={class:"row q-my-md q-mx-auto q-gutter-xl"},Z=n("p",{class:"text-orange"},"\u7DE8\u865F",-1),ee={style:{"font-weight":"600","font-size":"30px"}},pe={__name:"AdminTree",setup(le){const y=q(!1),v=["A\u5712\u5340","B\u5712\u5340","C\u5712\u5340"],d={required(l){return!!l||"\u6B04\u4F4D\u5FC5\u586B"},price(l){return l>=0||"\u50F9\u683C\u932F\u8AA4"}},s=_([]),e=_({_id:"",name:"",price:0,description:"",image:void 0,sell:!1,adopt:!1,kid:!0,flower:!1,harvest:!1,area:"",loading:!1}),V=l=>{l===-1?(e._id="",e.name="",e.price=0,e.description="",e.image=void 0,e.sell=!1,e.adopt=!1,e.kid=!0,e.flower=!1,e.harvest=!1,e.area="",e.loading=!1,e.idx=-1):(e._id=s[l]._id,e.name=s[l].name,e.price=s[l].price,e.description=s[l].description,e.image=s[l].image,e.sell=s[l].sell,e.adopt=s[l].adopt,e.kid=s[l].kid,e.flower=s[l].flower,e.harvest=s[l].harvest,e.area=s[l].area,e.loading=!1,e.idx=l),e.dialog=!0},b=async()=>{var o,r;e.loading=!0;const l=new FormData;l.append("name",e.name),l.append("price",e.price),l.append("description",e.description),l.append("image",e.image),l.append("sell",e.sell),l.append("adopt",e.adopt),l.append("kid",e.kid),l.append("flower",e.flower),l.append("harvest",e.harvest),l.append("area",e.area);try{if(e._id.length===0){const{data:a}=await f.post("/trees",l);s.push(a.result),c.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:a}=await f.patch("/trees/"+e._id,l);s[e.idx]=a.result,c.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"})}e.dialog=!1}catch(a){c.fire({icon:"error",title:"\u5931\u6557",text:((r=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:r.message)||"\u767C\u751F\u932F\u8AA4"})}e.loading=!1};return(async()=>{var l,o;try{const{data:r}=await f.get("/trees/all");s.push(...r.result)}catch(r){c.fire({icon:"error",title:"\u5931\u6557",text:((o=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:o.message)||"\u767C\u751F\u932F\u8AA4"})}})(),(l,o)=>{const r=x("v-image-input");return g(),k(M,{id:"adminTree",class:"bg"},{default:i(()=>[n("div",O,[R,t(p,{class:"q-px-xl q-py-xs q-my-lg",label:"\u65B0\u589E\u8336\u6A39",color:"primary",size:"15px",onClick:o[0]||(o[0]=a=>V(-1))}),t(F),t(C,{modelValue:e.dialog,"onUpdate:modelValue":o[11]||(o[11]=a=>e.dialog=a),persistent:""},{default:i(()=>[n("div",j,[t(z,null,{default:i(()=>[t(E),U(t(p,{icon:"close",flat:"",round:"",dense:""},null,512),[[I]])]),_:1}),n("div",H,[n("h6",J,m(e._id.length>0?"\u7DE8\u8F2F\u8336\u6A39\u8CC7\u6599":"\u65B0\u589E\u8336\u6A39\u8CC7\u6599"),1),t(P,{onSubmit:b,class:"q-gutter-md"},{default:i(()=>[n("div",null,[t(r,{modelValue:e.image,"onUpdate:modelValue":o[1]||(o[1]=a=>e.image=a),style:{margin:"2rem"}},null,8,["modelValue"]),t(K,{anchor:"center right",self:"center left",offset:[-200,10]},{default:i(()=>[L,G,W]),_:1})]),t(h,{class:"wid",filled:"",modelValue:e.name,"onUpdate:modelValue":o[2]||(o[2]=a=>e.name=a),label:"\u8336\u6A39\u540D\u7A31",rules:[d.required]},null,8,["modelValue","rules"]),t(h,{class:"wid",filled:"",modelValue:e.price,"onUpdate:modelValue":o[3]||(o[3]=a=>e.price=a),label:"\u8336\u6A39\u50F9\u683C",rules:[d.required,d.price]},null,8,["modelValue","rules"]),t(h,{class:"wid",filled:"",modelValue:e.description,"onUpdate:modelValue":o[4]||(o[4]=a=>e.description=a),label:"\u8336\u6A39\u8AAA\u660E",clearable:"",type:"textarea",color:"red-12",onKeydown:l.processTextareaFill,onFocus:l.processTextareaFill,rules:[d.required]},null,8,["modelValue","onKeydown","onFocus","rules"]),t(N,{class:"wid",filled:"",modelValue:e.area,"onUpdate:modelValue":o[5]||(o[5]=a=>e.area=a),options:v,label:"\u8336\u6A39\u5712\u5340",rules:[d.required]},null,8,["modelValue","rules"]),t(u,{modelValue:e.adopt,"onUpdate:modelValue":o[6]||(o[6]=a=>e.adopt=a),"checked-icon":"check",color:"green",label:"\u6709\u7121\u8A8D\u990A\u8005","unchecked-icon":"clear"},null,8,["modelValue"]),t(u,{modelValue:e.kid,"onUpdate:modelValue":o[7]||(o[7]=a=>e.kid=a),"checked-icon":"check",color:"green",label:"\u6A39\u82D7\u72C0\u614B","unchecked-icon":"clear"},null,8,["modelValue"]),t(u,{modelValue:e.flower,"onUpdate:modelValue":o[8]||(o[8]=a=>e.flower=a),"checked-icon":"check",color:"green",label:"\u958B\u82B1\u72C0\u614B","unchecked-icon":"clear"},null,8,["modelValue"]),t(u,{modelValue:e.harvest,"onUpdate:modelValue":o[9]||(o[9]=a=>e.harvest=a),"checked-icon":"check",color:"green",label:"\u6536\u6210\u72C0\u614B","unchecked-icon":"clear"},null,8,["modelValue"]),t(u,{modelValue:e.sell,"onUpdate:modelValue":o[10]||(o[10]=a=>e.sell=a),"checked-icon":"check",color:"green",label:"\u4E0A\u67B6\u72C0\u614B","unchecked-icon":"clear"},null,8,["modelValue"]),n("div",X,[t(p,{label:"\u9001\u51FA",type:"submit",loading:y.value,color:"secondary",style:{width:"100%",padding:"1rem","font-weight":"300"}},null,8,["loading"])])]),_:1})])])]),_:1},8,["modelValue"]),n("div",Y,[(g(!0),T(S,null,B(s,(a,Q)=>(g(),k(A,{class:"col-3 my-card",flat:"",key:a._id},{default:i(()=>[t(w,{horizontal:""},{default:i(()=>[t($,{class:"col-5",src:a.image},null,8,["src"]),t(w,null,{default:i(()=>[Z,n("p",ee,m(a.name),1),n("p",null,m(a.area)+" | "+m(a.adopt?"\u5DF2":"\u672A")+"\u8A8D\u990A",1),t(D,null,{default:i(()=>[t(p,{color:"secondary",onClick:ae=>V(Q),label:"MORE"},null,8,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))])])]),_:1})}}};export{pe as default};
